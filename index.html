<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Qu·∫£n L√Ω T√†i Ch√≠nh C√° Nh√¢n</title>

    <link rel="manifest" href="./manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="T√†i Ch√≠nh">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#3b82f6">
    <meta name="msapplication-navbutton-color" content="#3b82f6">

    <link rel="apple-touch-icon" href="./logo-finance.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./logo-finance.png">
    <link rel="shortcut icon" href="./logo-finance.png" type="image/png">

    <link rel="apple-touch-icon" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="57x57" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./LogoFinance.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./LogoFinance.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./LogoFinance.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./LogoFinance.png">
    <link rel="shortcut icon" href="./LogoFinance.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="./styles.css">
</head>
<body class="font-sans antialiased ...">
    <div class="theme-switch-wrapper">
        <label class="theme-switch" for="darkModeToggleCheckbox">
            <input type="checkbox" id="darkModeToggleCheckbox">
            <div class="slider round">
                <span class="sun-icon">‚òÄÔ∏è</span>
                <span class="moon-icon">üåô</span>
            </div>
        </label>
    </div>

    <header class="app-header">
        <div class="header-content">
            <h1 class="header-title">
                <span class="header-icon">üí∞</span>
                Qu·∫£n L√Ω T√†i Ch√≠nh
            </h1>
            <div class="header-summary">
                <div class="summary-card income">
                    <span class="summary-label">Thu nh·∫≠p th√°ng</span>
                    <span class="summary-value" id="header-income">0 ‚Ç´</span>
                </div>
                <div class="summary-card expense">
                    <span class="summary-label">Chi ti√™u th√°ng</span>
                    <span class="summary-value" id="header-expense">0 ‚Ç´</span>
                </div>
                <div class="summary-card balance">
                    <span class="summary-label">S·ªë d∆∞</span>
                    <span class="summary-value" id="header-balance">0 ‚Ç´</span>
                </div>
            </div>
        </div>
    </header>

    <div id="message-box" class="message-box" style="display: none;"></div>

    <main class="main-container">
        <div class="tab-content-container">
            <section id="tab-transactions" class="tab-content active">
                <div class="quick-add-section">
                    <h2 class="section-title">
                        <span class="section-icon">‚úèÔ∏è</span>
                        Th√™m Giao D·ªãch Nhanh
                    </h2>

                    <form id="transaction-form" class="transaction-form">
                        <div class="form-row">
                            <label class="form-label">Lo·∫°i giao d·ªãch</label>
                            <div class="radio-group">
                                <label class="radio-option income-option">
                                    <input type="radio" name="type" value="Thu" required>
                                    <span class="radio-custom"></span>
                                    <span class="radio-text">Thu nh·∫≠p</span>
                                </label>
                                <label class="radio-option expense-option">
                                    <input type="radio" name="type" value="Chi" checked required>
                                    <span class="radio-custom"></span>
                                    <span class="radio-text">Chi ti√™u</span>
                                </label>
                                <label class="radio-option transfer-option">
                                    <input type="radio" name="type" value="Transfer" required>
                                    <span class="radio-custom"></span>
                                    <span class="radio-text">Chuy·ªÉn ti·ªÅn</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-row">
							<label for="amount-input" class="form-label">S·ªë ti·ªÅn</label>
							<div class="amount-input-group flex items-center bg-[var(--bg-tertiary)] rounded-2xl border border-[var(--border-color)] px-4 py-3 mt-1" style="min-height:58px;">
								<input type="text"
									   id="amount-input"
									   class="amount-input flex-1 bg-transparent outline-none border-0 text-xl text-[var(--text-primary)] h-[24px] min-h-[24px] px-1"
									   placeholder="Nh·∫≠p s·ªë ti·ªÅn"
									   inputmode="decimal"
									   required>
								<select id="currency-selector" class="currency-selector ml-2 bg-[var(--bg-secondary)] text-[var(--text-primary)] rounded-xl px-3 py-2 border border-[var(--border-color)]">
									<option value="VND">VNƒê</option>
									<option value="USD">USD</option>
								</select>
							</div>
						</div>

                        <div class="form-row" id="category-row">
                            <label for="category-select" class="form-label">H·∫°ng m·ª•c</label>
                            <select id="category-select" class="form-select" required>
                                <option value="">Ch·ªçn h·∫°ng m·ª•c...</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <label for="account-from" class="form-label" id="account-from-label">T√†i kho·∫£n</label>
                            <select id="account-from" class="form-select" required>
                                <option value="">Ch·ªçn t√†i kho·∫£n...</option>
                            </select>
                        </div>

                        <div class="form-row" id="to-account-row" style="display: none;">
                            <label for="account-to" class="form-label">ƒê·∫øn t√†i kho·∫£n</label>
                            <select id="account-to" class="form-select">
                                <option value="">Ch·ªçn t√†i kho·∫£n nh·∫≠n...</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <label for="description-input" class="form-label">M√¥ t·∫£</label>
                            <input type="text"
                                   id="description-input"
                                   class="form-input"
                                   placeholder="M√¥ t·∫£ giao d·ªãch (t√πy ch·ªçn)"
                                   list="description-suggestions">
                            <datalist id="description-suggestions"></datalist>
                        </div>

                        <div class="form-row">
                            <label for="datetime-input" class="form-label">Ng√†y & Gi·ªù</label>
                            <input type="datetime-local"
                                   id="datetime-input"
                                   class="form-input"
                                   required>
                        </div>

                        <div id="suggestion-area" class="suggestion-area" style="display: none;">
                            <div class="suggestion-content">
                                <span class="suggestion-text">
                                    G·ª£i √Ω: <strong id="suggestion-desc"></strong> - <strong id="suggestion-amount"></strong>
                                </span>
                                <div class="suggestion-actions">
                                    <button type="button" id="apply-suggestion" class="btn-suggestion apply">√Åp d·ª•ng</button>
                                    <button type="button" id="dismiss-suggestion" class="btn-suggestion dismiss">B·ªè qua</button>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="submit-btn" id="submit-btn">
                            <span class="btn-icon">‚ûï</span>
                            <span class="btn-text">Th√™m Giao D·ªãch</span>
                        </button>
                    </form>
                </div>

                <div class="transaction-list-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <span class="section-icon">üìã</span>
                            Giao D·ªãch G·∫ßn ƒê√¢y
                        </h2>
                        <div class="filter-controls">
                            <select id="filter-period" class="filter-select">
                                <option value="today">H√¥m nay</option>
                                <option value="week">Tu·∫ßn n√†y</option>
                                <option value="month" selected>Th√°ng n√†y</option>
                                <option value="all">T·∫•t c·∫£</option>
                            </select>
                            <input type="date" id="filter-date" class="filter-date">
                        </div>
                    </div>

                    <div class="transaction-list" id="transaction-list">
                        </div>

                    <div id="no-transactions" class="no-data" style="display: none;">
                        <span class="no-data-icon">üìù</span>
                        <span class="no-data-text">Ch∆∞a c√≥ giao d·ªãch n√†o</span>
                    </div>
                </div>
            </section>

            <section id="tab-history" class="tab-content">
				<div class="transaction-calendar-section">
					<h3 class="subsection-title">üìÖ L·ªãch Giao D·ªãch</h3>
					
					<div class="calendar-container">
						<div class="calendar-header">
							<div class="month-navigation">
								<button class="nav-btn" id="prev-month-btn">‚Äπ</button>
								<div class="current-month" id="current-month-display">Th√°ng n√†y</div>
								<button class="nav-btn" id="next-month-btn">‚Ä∫</button>
							</div>
							
							<div class="month-summary-cards">
								<div class="summary-card income">
									<div class="summary-label">T·ªïng thu nh·∫≠p</div>
									<div class="summary-value" id="calendar-total-income">0 ‚Ç´</div>
								</div>
								<div class="summary-card expense">
									<div class="summary-label">T·ªïng ƒë√£ chi</div>
									<div class="summary-value" id="calendar-total-expense">0 ‚Ç´</div>
								</div>
							</div>
						</div>
						
						<div class="calendar-grid">
							<div class="calendar-weekdays">
								<div class="weekday">T2</div>
								<div class="weekday">T3</div>
								<div class="weekday">T4</div>
								<div class="weekday">T5</div>
								<div class="weekday">T6</div>
								<div class="weekday">T7</div>
								<div class="weekday">CN</div>
							</div>
							
							<div class="calendar-days-grid" id="calendar-days-grid">
								<!-- Days will be generated by JavaScript -->
							</div>
						</div>
					</div>
				</div>

				<!-- Transaction Detail Modal -->
				<div id="day-detail-modal" class="modal" style="display: none;">
					<div class="modal-content">
						<div class="modal-header">
							<h3 id="modal-day-title">Giao d·ªãch ng√†y</h3>
							<button class="modal-close" id="close-day-modal">&times;</button>
						</div>
						<div class="modal-body" id="modal-day-transactions">
							<!-- Transaction details will be loaded here -->
						</div>
					</div>
				</div>
				<div class="tab-header">
                    <h2 class="tab-title">
                        <span class="tab-icon">üè¶</span>
                        L·ªãch S·ª≠ & ƒê·ªëi So√°t
                    </h2>
                </div>

                <div class="account-balances-section">
                    <h3 class="subsection-title">S·ªë D∆∞ T√†i Kho·∫£n</h3>
                    <div class="account-balance-grid" id="account-balance-grid">
                        </div>
                </div>

                <div class="reconciliation-section">
                    <h3 class="subsection-title">ƒê·ªëi So√°t T√†i Kho·∫£n</h3>
                    <div class="reconciliation-container">
                        <div class="reconciliation-scroll">
                            <table class="reconciliation-table" id="reconciliation-table">
                                <thead>
                                    <tr>
                                        <th class="sticky-col">M·ª•c / T√†i kho·∫£n</th>
                                        </tr>
                                </thead>
                                <tbody>
                                    </tbody>
                            </table>
                        </div>
                        <div class="scroll-hint">‚Üê Vu·ªët ngang ƒë·ªÉ xem th√™m c·ªôt ‚Üí</div>
                    </div>
                </div>

                <div class="reconciliation-history-section">
                    <h3 class="subsection-title">L·ªãch S·ª≠ ƒê·ªëi So√°t</h3>
                    <div class="reconciliation-history" id="reconciliation-history">
                        </div>
                </div>
            </section>

            <section id="tab-statistics" class="tab-content">
                <div class="tab-header">
                    <h2 class="tab-title">
                        <span class="tab-icon">üìä</span>
                        Th·ªëng K√™ & Bi·ªÉu ƒê·ªì
                    </h2>
                    <select id="stats-period" class="bg-[var(--bg-secondary)] text-[var(--text-primary)] border border-[var(--border-color)] rounded-xl px-4 py-2">
                        <option value="week">Tu·∫ßn n√†y</option>
						<option value="month">Th√°ng n√†y</option>
                        <option value="quarter">Qu√Ω n√†y</option>
                        <option value="year">NƒÉm n√†y</option>
                        <option value="custom">T√πy ch·ªânh</option>
                    </select>
                </div>

                <div class="stats-summary">
                    <div class="stats-card income-card">
                        <div class="stats-icon">üí∞</div>
                        <div class="stats-content">
                            <div class="stats-label">T·ªïng Thu Nh·∫≠p</div>
                            <div class="stats-value" id="stats-total-income">0 ‚Ç´</div>
                            <div class="stats-change" id="stats-income-change">0%</div>
                        </div>
                    </div>

                    <div class="stats-card expense-card">
                        <div class="stats-icon">üí∏</div>
                        <div class="stats-content">
                            <div class="stats-label">T·ªïng Chi Ti√™u</div>
                            <div class="stats-value" id="stats-total-expense">0 ‚Ç´</div>
                            <div class="stats-change" id="stats-expense-change">0%</div>
                        </div>
                    </div>

                    <div class="stats-card balance-card">
                        <div class="stats-icon">‚öñÔ∏è</div>
                        <div class="stats-content">
                            <div class="stats-label">S·ªë D∆∞ R√≤ng</div>
                            <div class="stats-value" id="stats-net-balance">0 ‚Ç´</div>
                            <div class="stats-change" id="stats-balance-change">0%</div>
                        </div>
                    </div>
                </div>

                <div class="chart-section">
                    <div class="chart-header">
                        <h3 class="chart-title">Chi Ti√™u Theo Danh M·ª•c</h3>
                        <div class="chart-controls">
                            <select id="chart-type" class="chart-type-selector">
                                <option value="doughnut">Bi·ªÉu ƒë·ªì tr√≤n</option>
                                <option value="bar">Bi·ªÉu ƒë·ªì c·ªôt</option>
                            </select>
                        </div>
                    </div>

                    <div class="chart-container-wrapper">
                        <div class="chart-container" id="expense-chart-container">
                            <canvas id="expense-chart"></canvas>
                        </div>

                        <div class="chart-legend" id="expense-legend">
                            </div>
                    </div>
                </div>

                <div class="trend-section">
                    <h3 class="subsection-title">Xu H∆∞·ªõng 7 Ng√†y Qua</h3>
                    <div class="trend-chart-container">
                        <canvas id="trend-chart"></canvas>
                    </div>
                </div>

                <div class="comparison-section">
                    <h3 class="subsection-title">So S√°nh Th√°ng</h3>
                    <div class="comparison-chart-container">
                        <canvas id="comparison-chart"></canvas>
                    </div>
                </div>

				<div class="detailed-stats-section">
					<h3 class="subsection-title">Th·ªëng K√™ Chi Ti·∫øt</h3>
					<div class="stats-table-container">
						<table class="stats-table">
							<thead>
								<tr>
									<th class="text-left">Danh M·ª•c</th>
									<th class="text-right">S·ªë Ti·ªÅn</th>
									<th class="text-right">%</th>
									<th class="text-center">T·ª∑ L·ªá</th>
								</tr>
							</thead>
							<tbody id="detailed-stats-tbody">
								<!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c render b·ªüi JavaScript -->
							</tbody>
						</table>
					</div>
				</div>
            </section>

            <section id="tab-categories" class="tab-content">
                <div class="tab-header">
                    <h2 class="tab-title">
                        <span class="tab-icon">üè∑Ô∏è</span>
                        Qu·∫£n L√Ω Danh M·ª•c
                    </h2>
                </div>

                <div class="category-section">
                    <h3 class="category-section-title">
                        <span class="category-icon income">üí∞</span>
                        Danh M·ª•c Thu Nh·∫≠p
                    </h3>

                    <div class="add-category-form">
                        <div class="form-group">
                            <input type="text"
                                   id="new-income-category"
                                   class="category-input"
                                   placeholder="T√™n danh m·ª•c thu nh·∫≠p m·ªõi">
                            <button id="add-income-category" class="add-category-btn">
                                <span class="btn-icon">‚ûï</span>
                                Th√™m
                            </button>
                        </div>
                        <div id="new-income-category-error" class="input-error-message" style="display: none;"></div>
                    </div>

                    <div class="category-list">
                        <ul id="income-category-list" class="category-items">
                            </ul>
                    </div>
                </div>

                <div class="category-section">
                    <h3 class="category-section-title">
                        <span class="category-icon expense">üí∏</span>
                        Danh M·ª•c Chi Ti√™u
                    </h3>

                    <div class="add-category-form">
                        <div class="form-group">
                            <input type="text"
                                   id="new-expense-category"
                                   class="category-input"
                                   placeholder="T√™n danh m·ª•c chi ti√™u m·ªõi">
                            <button id="add-expense-category" class="add-category-btn">
                                <span class="btn-icon">‚ûï</span>
                                Th√™m
                            </button>
                        </div>
                        <div id="new-expense-category-error" class="input-error-message" style="display: none;"></div>
                    </div>

                    <div class="category-list">
                        <ul id="expense-category-list" class="category-items">
                            </ul>
                    </div>
                </div>

                <div class="category-section">
                    <h3 class="category-section-title">
                        <span class="category-icon account">üè¶</span>
                        T√†i Kho·∫£n
                    </h3>

                    <div class="add-category-form">
                        <div class="form-group">
                            <input type="text"
                                   id="new-account"
                                   class="category-input"
                                   placeholder="T√™n t√†i kho·∫£n m·ªõi">
                            <button id="add-account" class="add-category-btn">
                                <span class="btn-icon">‚ûï</span>
                                Th√™m
                            </button>
                        </div>
                        <div id="new-account-error" class="input-error-message" style="display: none;"></div>
                    </div>

                    <div class="category-list">
                        <ul id="account-list" class="category-items">
                            </ul>
                    </div>
                </div>
            </section>

            <section id="tab-settings" class="tab-content">
                <div class="tab-header">
                    <h2 class="tab-title">
                        <span class="tab-icon">‚öôÔ∏è</span>
                        C√†i ƒê·∫∑t & Backup
                    </h2>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">
                        <span class="settings-icon">üé®</span>
                        Giao Di·ªán
                    </h3>

				<div class="theme-options">
				  <label class="theme-option">
					<input type="radio" name="theme" value="light" checked>
					<span class="theme-preview">üåû</span>
					<span class="theme-label">S√°ng</span>
				  </label>
				  <label class="theme-option">
					<input type="radio" name="theme" value="dark">
					<span class="theme-preview">üåô</span>
					<span class="theme-label">T·ªëi</span>
				  </label>
				  <label class="theme-option">
					<input type="radio" name="theme" value="auto">
					<span class="theme-preview">üîÑ</span>
					<span class="theme-label">T·ª± ƒë·ªông</span>
				  </label>
				</div>
                <div class="settings-section">
                    <h3 class="settings-section-title">
                        <span class="settings-icon">üíæ</span>
                        Qu·∫£n L√Ω D·ªØ Li·ªáu
                    </h3>

                    <div class="data-actions">
                        <button id="export-json" class="action-btn export">
                            <span class="btn-icon">üì•</span>
                            <div class="btn-content">
                                <span class="btn-title">Xu·∫•t JSON</span>
                                <span class="btn-subtitle">Backup to√†n b·ªô d·ªØ li·ªáu</span>
                            </div>
                        </button>

                        <button id="export-csv" class="action-btn export">
                            <span class="btn-icon">üìä</span>
                            <div class="btn-content">
                                <span class="btn-title">Xu·∫•t CSV</span>
                                <span class="btn-subtitle">D·ªØ li·ªáu giao d·ªãch</span>
                            </div>
                        </button>

                        <button id="import-data" class="action-btn import">
                            <span class="btn-icon">üì§</span>
                            <div class="btn-content">
                                <span class="btn-title">Nh·∫≠p D·ªØ Li·ªáu</span>
                                <span class="btn-subtitle">Kh√¥i ph·ª•c t·ª´ file JSON</span>
                            </div>
                        </button>

                        <input type="file" id="import-file" accept=".json" style="display: none;">
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">
                        <span class="settings-icon">üí±</span>
                        Ti·ªÅn T·ªá
                    </h3>

                    <div class="currency-settings">
                        <div class="setting-item">
                            <label class="setting-label">T·ª∑ gi√° USD/VNƒê</label>
                            <input type="number"
                                   id="usd-rate"
                                   class="setting-input"
                                   value="25000"
                                   min="1000"
                                   max="50000">
                            <div id="usd-rate-error" class="input-error-message" style="display: none;"></div>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Ti·ªÅn t·ªá m·∫∑c ƒë·ªãnh</label>
                            <select id="default-currency" class="setting-select">
                                <option value="VND">Vi·ªát Nam ƒê·ªìng (‚Ç´)</option>
                                <option value="USD">US Dollar ($)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-section-title">
                        <span class="settings-icon">‚ÑπÔ∏è</span>
                        Th√¥ng Tin ·ª®ng D·ª•ng
                    </h3>

                    <div class="app-info">
                        <div class="info-item">
                            <span class="info-label">Phi√™n b·∫£n</span>
                            <span class="info-value">2.0.0</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label">T·ªïng giao d·ªãch</span>
                            <span class="info-value" id="total-transactions">0</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label">Dung l∆∞·ª£ng d·ªØ li·ªáu</span>
                            <span class="info-value" id="data-size">0 KB</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label">L·∫ßn backup cu·ªëi</span>
                            <span class="info-value" id="last-backup">Ch∆∞a backup</span>
                        </div>
                    </div>
                </div>

                <div class="settings-section danger-section">
                    <h3 class="settings-section-title">
                        <span class="settings-icon">‚ö†Ô∏è</span>
                        V√πng Nguy Hi·ªÉm
                    </h3>

                    <div class="danger-actions">
                        <button id="clear-data" class="action-btn danger">
                            <span class="btn-icon">üóëÔ∏è</span>
                            <div class="btn-content">
                                <span class="btn-title">X√≥a To√†n B·ªô D·ªØ Li·ªáu</span>
                                <span class="btn-subtitle">Kh√¥ng th·ªÉ kh√¥i ph·ª•c</span>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <nav class="bottom-nav">
        <button class="nav-item active" data-tab="transactions">
            <span class="nav-icon">üí≥</span>
            <span class="nav-label">Giao D·ªãch</span>
        </button>

        <button class="nav-item" data-tab="history">
            <span class="nav-icon">üè¶</span>
            <span class="nav-label">L·ªãch S·ª≠</span>
        </button>

        <button class="nav-item" data-tab="statistics">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">Th·ªëng K√™</span>
        </button>

        <button class="nav-item" data-tab="categories">
            <span class="nav-icon">üè∑Ô∏è</span>
            <span class="nav-label">Danh M·ª•c</span>
        </button>

        <button class="nav-item" data-tab="settings">
            <span class="nav-icon">‚öôÔ∏è</span>
            <span class="nav-label">C√†i ƒê·∫∑t</span>
        </button>
    </nav>

    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <span class="loading-text">ƒêang t·∫£i...</span>
        </div>
    </div>

    <script src="./js/utils.js"></script>
	<script src="./js/categories.js"></script>
	<script src="./js/settings.js"></script>
	<script src="./js/transactions.js"></script>
	<script src="./js/history.js"></script>
	<script src="./js/statistics.js"></script>
	<script src="./js/app.js"></script>

	<script>
	if (typeof Utils !== 'undefined' && Utils.UIUtils) {
		// Mapping icons cho c√°c danh m·ª•c ph·ªï bi·∫øn
		Utils.UIUtils.categoryIcons = {
			// ... (b·∫°n gi·ªØ nguy√™n ph·∫ßn icon c·ªßa b·∫°n ·ªü tr√™n ƒë√¢y) ...
			// Copy t·∫•t c·∫£ mapping icon nh∆∞ b·∫°n ƒë√£ khai b√°o
		};

		// H√†m l·∫•y icon cho danh m·ª•c
		Utils.UIUtils.getCategoryIcon = function(categoryName) {
			if (!categoryName || typeof categoryName !== 'string') {
				return 'üì¶'; // Icon m·∫∑c ƒë·ªãnh
			}
			// T√¨m ki·∫øm ch√≠nh x√°c tr∆∞·ªõc
			if (this.categoryIcons[categoryName]) {
				return this.categoryIcons[categoryName];
			}
			// T√¨m ki·∫øm kh√¥ng ph√¢n bi·ªát hoa th∆∞·ªùng
			const lowerCaseName = categoryName.toLowerCase();
			for (const [key, icon] of Object.entries(this.categoryIcons)) {
				if (key.toLowerCase() === lowerCaseName) {
					return icon;
				}
			}
			// T√¨m ki·∫øm t·ª´ kh√≥a ch·ª©a trong t√™n danh m·ª•c
			for (const [key, icon] of Object.entries(this.categoryIcons)) {
				if (lowerCaseName.includes(key.toLowerCase()) || key.toLowerCase().includes(lowerCaseName)) {
					return icon;
				}
			}
			// Icon m·∫∑c ƒë·ªãnh d·ª±a tr√™n t·ª´ kh√≥a
			if (lowerCaseName.includes('ƒÉn') || lowerCaseName.includes('an') || lowerCaseName.includes('food')) {
				return 'üç¥';
			} else if (lowerCaseName.includes('xe') || lowerCaseName.includes('di') || lowerCaseName.includes('transport')) {
				return 'üöó';
			} else if (lowerCaseName.includes('mua') || lowerCaseName.includes('shop')) {
				return 'üõí';
			} else if (lowerCaseName.includes('nh√†') || lowerCaseName.includes('nha') || lowerCaseName.includes('house')) {
				return 'üè†';
			} else if (lowerCaseName.includes('y t·∫ø') || lowerCaseName.includes('y te') || lowerCaseName.includes('health')) {
				return 'üè•';
			} else if (lowerCaseName.includes('h·ªçc') || lowerCaseName.includes('hoc') || lowerCaseName.includes('education')) {
				return 'üìö';
			} else if (lowerCaseName.includes('l∆∞∆°ng') || lowerCaseName.includes('luong') || lowerCaseName.includes('salary')) {
				return 'üí∞';
			} else if (lowerCaseName.includes('ng√¢n h√†ng') || lowerCaseName.includes('ngan hang') || lowerCaseName.includes('bank')) {
				return 'üè¶';
			}
			return 'üì¶'; // Icon m·∫∑c ƒë·ªãnh cu·ªëi c√πng
		};

		// H√†m l·∫•y m√†u cho danh m·ª•c (n·∫øu ch∆∞a c√≥)
		if (!Utils.UIUtils.getCategoryColor) {
			Utils.UIUtils.categoryColors = [
				'#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6',
				'#06b6d4', '#84cc16', '#f97316', '#ec4899', '#6366f1',
				'#14b8a6', '#f43f5e', '#a855f7', '#22c55e', '#eab308',
				'#0ea5e9', '#8b5cf6', '#f97316', '#ec4899', '#6366f1'
			];
			Utils.UIUtils.getCategoryColor = function(categoryName, index = 0) {
				// Hash function ƒë·ªÉ t·∫°o m√†u consistent cho m·ªói t√™n danh m·ª•c
				let hash = 0;
				if (categoryName && typeof categoryName === 'string') {
					for (let i = 0; i < categoryName.length; i++) {
						const char = categoryName.charCodeAt(i);
						hash = ((hash << 5) - hash) + char;
						hash = hash & hash; // Convert to 32bit integer
					}
				}
				const colorIndex = Math.abs(hash + index) % this.categoryColors.length;
				return this.categoryColors[colorIndex];
			};
		}

		// H√†m hex to rgba n·∫øu ch∆∞a c√≥
		if (!Utils.UIUtils.hexToRgba) {
			Utils.UIUtils.hexToRgba = function(hex, alpha = 1) {
				const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
				if (result) {
					const r = parseInt(result[1], 16);
					const g = parseInt(result[2], 16);
					const b = parseInt(result[3], 16);
					return `rgba(${r}, ${g}, ${b}, ${alpha})`;
				}
				return hex; // Tr·∫£ v·ªÅ hex g·ªëc n·∫øu kh√¥ng parse ƒë∆∞·ª£c
			};
		}
	}

	// ƒêƒÉng k√Ω Service Worker cho PWA (Offline & Cache)
	if ('serviceWorker' in navigator) {
		window.addEventListener('load', function() {
			navigator.serviceWorker.register('./sw.js')
				.then(function(registration) {
					console.log('Service Worker registered with scope:', registration.scope);
				})
				.catch(function(error) {
					console.log('Service Worker registration failed:', error);
				});
		});
	}
	</script>
</body>
</html>